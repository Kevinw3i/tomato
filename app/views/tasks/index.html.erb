<h1>Task List</h1>
<% if user_signed_in? %>
  <%= link_to "New Task", new_task_path %>
  <%= link_to 'Projects', projects_path %>
  
  <table class="table table-borderless table-hover">
    <thead>
      <tr>
        <th></th>
        <th>Project Name</th>
        <th>Task Name</th>
        <th>Tomato number</th>
        <th>Tag</th>
        <th colspan="2">Action</th>
      </tr>
    </thead>
    
    <tbody>
      <% @tasks.each do |task| %>
        <tr>
          <td>
            <%= link_to tictacs_path do %>
              <i class="far fa-play-circle"></i>
            <% end %>
          </td>
          <td><%= task.project.project_name %></td>
          <td><%= link_to task.task_name, task_path(task.id) %></td>
          <td><%= task.tomato_num %></td>
          <td><%= display_tag task.tag_items %></td>
          <td><%= link_to '編輯', edit_task_path(task.id) %></td>
          <td><%= 
            link_to '刪除', 
            task_path(task.id),
            method:'delete',
            data: {confirm: '真的要刪除喵?'} 
          %></td>
        </tr>
      <% end %>   
    </tbody>   
  </table>

  <div class="row p-2">
    <div class="col-2"></div>
    <div class="col-2">Project Name</div>
    <div class="col-2">Task Name</div>
    <div class="col-2">Tomato number</div>
    <div class="col-2">Tag</div>
    <div class="col-2">Action</div>
  </div>

   <div data-controller="drag" data-drag-url="/tasks/:id/drag">
    <% @tasks.order(position: :asc).each do |task| %>
      <div class="row p-2 task-hover" data-id="<%= task.id %>">
        <div class="col-2">
          <%= link_to tictacs_path do %>
            <i class="far fa-play-circle"></i>
          <% end %>
        </div>
        <div class="col-2"><%= task.project.project_name %></div>
        <div class="col-2"><%= link_to task.task_name, task_path(task.id) %></div>
        <div class="col-2"><%= task.tomato_num %></div>
        <div class="col-2"><%= display_tag task.tag_items %></div>
        <div class="col-1"><%= link_to '編輯', edit_task_path(task.id) %></div>
        <div class="col-1"><%= 
          link_to '刪除', 
          task_path(task.id),
          method:'delete',
          data: {confirm: '真的要刪除喵?'} 
        %></div>
      </div>
    <% end %> 
  </div>

<% else %>
  <%= link_to "New Task", new_user_session_path %>
<% end %>
